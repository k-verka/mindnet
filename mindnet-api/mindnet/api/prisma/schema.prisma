generator client {
  binaryTargets = ["native", "debian-openssl-1.1.x", "debian-openssl-3.0.x"]
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String    @id @default(uuid())
  name        String?
  avatar_url  String?
  timezone    String    @default("UTC")
  slots_free  Int       @default(7)
  slots_total Int       @default(7)
  created_at  DateTime  @default(now())
  contacts    Contact[]
  ideas       Idea[]
  commits     Commit[]
}

model Contact {
  id          String   @id @default(uuid())
  owner_id    String
  owner       User     @relation(fields: [owner_id], references: [id])
  name        String
  birthday    DateTime?
  note        String?
  telegram    String?
  created_at  DateTime @default(now())
}

model Idea {
  id          String   @id @default(uuid())
  owner_id    String
  owner       User     @relation(fields: [owner_id], references: [id])
  title       String
  summary     String?
  fork_from   String?
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
  commits     Commit[]
}

model Commit {
  id           String   @id @default(uuid())
  idea_id      String
  idea         Idea     @relation(fields: [idea_id], references: [id])
  author_id    String
  author       User     @relation(fields: [author_id], references: [id])
  text         String?
  audio_url    String?
  duration_sec Int?
  via          String   @default("app") // app | telegram
  created_at   DateTime @default(now())
}
